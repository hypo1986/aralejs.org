<!DOCTYPE HTML>
<html lang="zh">
  <head>
    <meta charset="UTF-8">
    <title>Arale - 支付宝入门指南</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="nico 0.2.3" />
    <link type="image/x-icon" href="../static/css/favicon.ico" rel="icon">
    <link rel="stylesheet" href="../static/css/normalize.css" />
    <link rel="stylesheet" href="../static/css/site.css" />
    <link rel="stylesheet" href="../static/css/solarized.css" />
    <script src="http://static.alipayobjects.com/seajs/1.3.1/sea.js"></script>
    <script src="../static/js/arale-helper.js"></script>
    <script src="../static/js/site.js"></script><script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36247332-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = 'https://ssl.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<script>
  (function() {
    var data;
    seajs._package = data = {"name":"Arale","version":"0.0.1","root":"","description":"{ 基于 SeaJS 的前端解决方案，随<span class='heart'>❤</span>构建互联网应用 }","homepage":"http://aralejs.org","repository":{"type":"git","url":"https://github.com/aralejs/aralejs.org"},"bugs":{"url":"https://github.com/aralejs/aralejs.org/issues"}}

    if (data.spm && data.spm.alias) {
      delete data.spm.alias['$']
      seajs.config({ alias: data.spm.alias})
    } else {
      data.dependencies && (delete data.dependencies['$'])
      seajs.config({ alias: data.dependencies })
    }

    seajs.config({ alias: {} })

    // for alice
    for(var dep in data.dependencies) {
        // 如果依赖的是样式模块
        if (data.dependencies[dep].indexOf('.css') > 0) {
            seajs.use(dep);
        }
    }
  })();
</script>
    <!--[if lt IE 9]>
    <script src="../static/js/html5shiv.js"></script>
    <![endif]-->
    
<link rel="stylesheet" href="../static/style.css" />
<script src="../static/index.js"></script>

  </head>
  <body>
    <div id="body-wrapper">
      
<div id="title-wrapper">            
  <h1 id="title" class="inline">
    <a href="../">Arale</a>
  </h1>
  <input type="text" class="inline" id="search" placeholder="搜索 Arale 模块">
  <p id="description">{ 基于 SeaJS 的前端解决方案，随<span class='heart'>❤</span>构建互联网应用 }</p>
</div>
<div id="main-wrapper">
  <div class="main-block" id="document-wrapper">
    <div>
      <h2>Document</h2>
      <ol id="sidenav">
        <li><a href="../docs/about-arale.html">关于 Arale</a></li>
        <li><a href="../docs/getting-started.html">5 分钟快速上手</a></li>
        <li><a href="../docs/develop-components.html">开发一个 Arale 模块</a></li>
        <li><a href="../docs/online-status.html">模块线上状态</a></li>
        <li><a href="../docs/rules.html">开发规范</a></li>
        <li><a href="../docs/alice.html">Alice 样式解决方案</a></li>
        <li><a href="../contributing.html">加入我们</a></li>
      </ol>
    </div>
    <div style="display:none" id="J-alipay">
      <h2>Alipay</h2>
      <ol id="sidenav">
        <li><a href="../docs/alipay-overview.html">支付宝入门指南</a></li>
      </ol>
    </div>
  </div>
  <div class="main-block" id="doc-wrapper">
    <h1>支付宝入门指南</h1>
    <div id="content"><blockquote>
<p>在使用 Arale 之前可以先看一下 <a href="http://seajs.org/docs/">seajs</a> 和 <a href="https://github.com/spmjs/spm/wiki">spm</a> 的文档。</p>
</blockquote>
<h2 id="%E6%94%AF%E4%BB%98%E5%AE%9D%E5%86%85%E9%83%A8%E6%BA%90">支付宝内部源</h2>
<p>支付宝内部统一使用内部源，有很多内部定制的功能，编辑 <code>vi ~/.spm/config.json</code>。</p>

<pre>{
  &quot;sources&quot;: [&quot;modules.alipay.im:7000&quot;]
}
</pre>
<h2 id="seajs-%E9%85%8D%E7%BD%AE">seajs 配置</h2>
<p>在所有的 <code>head.vm</code> 文件部署 seajs，部署 seajs 的 cms 为 <code>alipay/tracker/seajs.vm</code>，你只要确定系统中是否已经存在这个区域。</p>

<pre>&lt;script charset=&quot;utf-8&quot; id=&quot;seajsnode&quot; 
    src=&quot;https:&#47;&#47;a.alipayobjects.com&#47;seajs&#47;1.3.1&#47;??sea.js,plugin-combo.js&quot;&gt;&lt;&#47;script&gt;
&lt;script&gt;
    seajs.config({
        alias: {
          &#39;$&#39;         : &#39;gallery&#47;jquery&#47;1.7.2&#47;jquery&#39;,
          &#39;$-debug&#39;   : &#39;gallery&#47;jquery&#47;1.7.2&#47;jquery-debug&#39;,
          &#39;jquery&#39;    : &#39;gallery&#47;jquery&#47;1.7.2&#47;jquery&#39;
        }
    });
&lt;&#47;script&gt;
</pre>

<p>seajs 的 base 为 <a href="https://a.alipayobjects.com">https://a.alipayobjects.com</a> ，这是由 seajs 的存放目录决定的。线上的部署目录为</p>

<pre>a.alipayobjects.com
    | - seajs
    | - gallery
    | - arale
    | - alipay
    | - cashier
    | - personal
    ` - ...
</pre>

<p>支付宝使用3个公共 root：gallery、arale、alipay，除此之外还有系统 root，如 cashier，personal。</p>

<p>每个组件的 id 形式为 <code>{{root}}/{{module}}/{{version}}/{{file}}</code>，比如 xbox 的 id 为 <code>alipay/xbox/0.9.8/xbox</code>，同时这也是文件路径，使用 xbox 可直接 use。</p>

<pre>seajs.use(&#39;alipay&#47;xbox&#47;0.9.8&#47;xbox&#39;, function(Xbox) {
    &#47;&#47; use Xbox
});
</pre>
<h2 id="%E6%9F%A5%E7%9C%8B%E7%BB%84%E4%BB%B6">查看组件</h2>
<blockquote>
<p>validator 最新的版本是什么？</p>

<p>xbox 0.9.8 到底上线了没有？</p>
</blockquote>

<p>经常会遇到这种问题，现在大家可以通过 <a href="online-status.html">online status</a> 查看组件的状态。</p>
<h2 id="%E5%BC%80%E5%8F%91-alipay-%E7%BB%84%E4%BB%B6">开发 alipay 组件</h2>
<p>alipay 组件存放在 <a href="http://git.alipay.im/">http://git.alipay.im/</a> 下，先到这里创建一个库，命名要加 <code>alipay.</code> 前缀。</p>

<p>根据<a href="./develop-components.html">组件编写文档</a>进行开发。</p>

<p><strong>注意：</strong> root 要配成 alipay。</p>

<p>开发完成后可以通过 <code>spm deploy --to=dev</code> 部署到 assets 服务器，<code>dev</code> 是对应的坑位。详细查看 <a href="https://github.com/spmjs/spm/wiki/spm-deploy">spm deploy 文档</a></p>

<p>如果有多个项目需要使用，要建个任务单发布到 test 环境，test 环境会定时同步到所有的开发环境。</p>
<h2 id="%E5%BC%80%E5%8F%91%E7%B3%BB%E7%BB%9F%E7%BB%84%E4%BB%B6">开发系统组件</h2>
<p>以 personal 消费记录为例子</p>

<p>在 /static 目录创建 consume 目录，在 consume 下执行 <code>spm init</code>。</p>

<p><strong>注意：</strong> root 要配成系统名。</p>

<p>需要忽略部分文件，在组件当前目录输入</p>

<pre>$ svn propset svn:ignore &#39;.gitignore&#39; .&#47; 
$ svn propset svn:ignore &#39;_site&#39; .&#47;
$ svn propset svn:ignore &#39;sea-modules&#39; .&#47;
</pre>

<p>其他可以参考 alipay 组件开发。</p>
<h2 id="%E7%BB%84%E4%BB%B6%E5%8F%91%E5%B8%83">组件发布</h2>
<p>组件的发布是通过研发平台的，本地将代码打包成 zip 后上传。</p>

<p>通过 <code>spm build --zip</code> 打包，zip 包里面的目录不包括 root，所以研发平台应该在 alipay 那一级上传。</p>
</div>
  </div>
</div>

    </div>
    <div id="footer-wrapper">
      <footer>
        <p class="powered">
<script type="text/javascript" charset="utf-8">
(function(){
  var _w = 72 , _h = 16;
  var param = {
    url:location.href,
    type:'3',
    count:'1', /**是否显示分享数，1显示(可选)*/
    appkey:'', /**您申请的应用appkey,显示分享来源(可选)*/
    title:'', /**分享的文字内容(可选，默认为所在页面的title)*/
    pic:'http://aralejs.org/static/arale.png', /**分享图片的路径(可选)*/
    ralateUid:'', /**关联用户的UID，分享微博会@该用户(可选)*/
	language:'zh_cn', /**设置语言，zh_cn|zh_tw(可选)*/
    rnd:new Date().valueOf()
  }
  var temp = [];
  for( var p in param ){
    temp.push(p + '=' + encodeURIComponent( param[p] || '' ) )
  }
  document.write('<iframe allowTransparency="true" frameborder="0" scrolling="no" src="http://hits.sinajs.cn/A1/weiboshare.html?' + temp.join('&') + '" width="'+ _w+'" height="'+_h+'"></iframe>')
})()
</script>
<a href="http://aralejs.org">Arale</a> •
<a href="http://aliceui.org">Alice</a> •
<a href="http://seajs.org">SeaJS</a> •
<a href="https://github.com/spmjs/spm">spm</a> •
<a href="http://lab.lepture.com/nico/">nico</a>

        </p>
      </footer>
    </div>
  </body>
</html>